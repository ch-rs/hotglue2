$(document).ready(function(){var t=!1;$(".page_browser_entry").live("mouseenter",function(e){t&&$(t).remove();var a=(a=(a='<span class="page_browser_actions">')+('<a href="'+$.glue.base_url+"?"+$(this).attr("id")+'/edit">edit</a> | ')+'<a href="#" class="page_browser_copy">copy</a> | ')+'<a href="#" class="page_browser_rename">rename</a> | '+'<a href="#" class="page_browser_delete">delete</a>';$(this).attr("id")+".head"!=$.glue.conf.page.startpage&&(a+=' | <a href="#" class="page_browser_set_startpage">startpage</a>'),a+="</span>",t=$(a),$(this).append(t)}),$(".page_browser_entry").bind("mouseleave",function(e){t&&($(t).remove(),t=!1)}),$(".page_browser_rename").live("click",function(e){var a=$(this).parents(".page_browser_entry"),r=$(a).attr("id"),t=prompt("Change the page URL",r);return null!=t&&t!=r&&$.glue.backend({method:"glue.rename_page",old:r,new:t},function(e){$(a).attr("id",t),$(a).children(".page_browser_pagename").html('<a href="'+$.glue.base_url+"?"+t+'">'+t+"</a>")}),!1}),$(".page_browser_copy").live("click",function(e){var a=$(this).parents(".page_browser_entry"),r=$(a).attr("id"),t=prompt("Specify a name",r+"-copy");return null!=t&&t!=r&&$.glue.backend({method:"glue.copy_page",old:r,new:t},function(e){copy=$(a).clone(),$(copy).attr("id",t),$(copy).find("span.page_browser_pagename").siblings().remove(),$(copy).children(".page_browser_pagename").html('<a href="'+$.glue.base_url+"?"+t+'">'+t+"</a>"),$(a).after(copy)}),!1}),$(".page_browser_delete").live("click",function(e){var t,n=$(this).parents(".page_browser_entry"),s=$(n).attr("id");return confirm("Really delete page "+s+"?")&&(t=[],$.glue.backend({method:"glue.revisions",pagename:s},function(e){for(var a in e)t.push(s+"."+e[a]);for(var r in t)$.glue.backend({method:"glue.delete_page",page:t[r]});$(n).hide("fast",function(){$(this).remove()})})),!1}),$(".page_browser_set_startpage").live("click",function(e){var a=$(this).parents(".page_browser_entry"),r=$(a).attr("id");$.glue.backend({method:"glue.set_startpage",page:r+".head"},function(e){$("#page_browser_startpage").remove(),$(a).children(".page_browser_pagename").after(' <span id="page_browser_startpage">[startpage]</span>'),$.glue.conf.page.startpage=r+".head",t&&$(a).trigger("mouseenter")})})});