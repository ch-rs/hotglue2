$(document).ready(function(){$(".video").live("glue-upload-dynamic-early",function(e,t,i,l){$(this).children("video").get(0).addEventListener("loadedmetadata",function(e){var t=e.target.videoWidth,i=e.target.videoHeight;"number"==typeof t&&0<t&&"number"==typeof i&&0<i&&(e=$(e.target).parent(),$(e).css("width",t+"px"),$(e).css("height",i+"px"),$.glue.object.save(e))},!1),$(this).css("width",$(this).width()+"px"),$(this).css("height",$(this).height()+"px"),"center"==t?($(this).css("left",i-$(this).outerWidth()/2+"px"),$(this).css("top",l-$(this).outerHeight()/2+"px")):($(this).css("left",i+"px"),$(this).css("top",l+"px")),$(this).css("visibility",$(this).data("orig_visibility")),$(this).removeData("orig_visibility"),$.glue.object.register(this),$.glue.object.save(this)});var e=$('<div style="height: 32px; width: 32px;" title="toggle automatic playback of video">');$(e).bind("click",function(e){var t=$(this).data("owner"),i=$(t).children("video").first();$(i).attr("autoplay")?($(i).removeAttr("autoplay"),$(this).removeClass("glue-menu-enabled"),$(this).addClass("glue-menu-disabled")):($(i).attr("autoplay","autoplay"),$(this).addClass("glue-menu-enabled"),$(this).removeClass("glue-menu-disabled"),$(i).get(0).play()),$.glue.object.save(t)}),$(e).bind("glue-menu-activate",function(e){var t=$(this).data("owner"),t=$(t).children("video").first();$(t).attr("autoplay")?($("#glue-contextmenu-video-autoplay").addClass("glue-menu-enabled"),$("#glue-contextmenu-video-autoplay").removeClass("glue-menu-disabled")):($("#glue-contextmenu-video-autoplay").removeClass("glue-menu-enabled"),$("#glue-contextmenu-video-autoplay").addClass("glue-menu-disabled"))}),$.glue.contextmenu.register("video","video-autoplay",e),e=$('<div style="height: 32px; width: 32px;" title="toggle looping of video">'),$(e).bind("click",function(e){var t=$(this).data("owner"),i=$(t).children("video").first();$(i).attr("loop")?($(i).removeAttr("loop"),$(this).removeClass("glue-menu-enabled"),$(this).addClass("glue-menu-disabled")):($(i).attr("loop","loop"),$(this).addClass("glue-menu-enabled"),$(this).removeClass("glue-menu-disabled")),$.glue.object.save(t)}),$(e).bind("glue-menu-activate",function(e){var t=$(this).data("owner"),t=$(t).children("video").first();$(t).attr("loop")?($("#glue-contextmenu-video-loop").addClass("glue-menu-enabled"),$("#glue-contextmenu-video-loop").removeClass("glue-menu-disabled")):($("#glue-contextmenu-video-loop").removeClass("glue-menu-enabled"),$("#glue-contextmenu-video-loop").addClass("glue-menu-disabled"))}),$.glue.contextmenu.register("video","video-loop",e),e=$('<div style="height: 32px; width: 32px;" title="show or hide control elements">'),$(e).bind("click",function(e){var t=$(this).data("owner"),i=$(t).children("video").first();$(i).attr("controls")?($(i).removeAttr("controls"),$(this).removeClass("glue-menu-enabled"),$(this).addClass("glue-menu-disabled")):($(i).attr("controls","controls"),$(this).addClass("glue-menu-enabled"),$(this).removeClass("glue-menu-disabled")),$.glue.object.save(t)}),$(e).bind("glue-menu-activate",function(e){var t=$(this).data("owner"),t=$(t).children("video").first();$(t).attr("controls")?($("#glue-contextmenu-video-controls").addClass("glue-menu-enabled"),$("#glue-contextmenu-video-controls").removeClass("glue-menu-disabled")):($("#glue-contextmenu-video-controls").removeClass("glue-menu-enabled"),$("#glue-contextmenu-video-controls").addClass("glue-menu-disabled"))}),$.glue.contextmenu.register("video","video-controls",e),e=$('<div style="height: 32px; width: 32px;" title="mute or unmute video">'),$(e).bind("click",function(e){var t=$(this).data("owner"),i=$(t).children("video").first();"muted"!=i.attr("audio")?($(i).attr("audio","muted"),$(this).addClass("glue-menu-enabled"),$(this).removeClass("glue-menu-disabled")):($(i).removeAttr("audio"),$(this).removeClass("glue-menu-enabled"),$(this).addClass("glue-menu-disabled")),$.glue.object.save(t)}),$(e).bind("glue-menu-activate",function(e){var t=$(this).data("owner");"muted"==$(t).children("video").first().attr("audio")?($("#glue-contextmenu-video-mute").addClass("glue-menu-enabled"),$("#glue-contextmenu-video-mute").removeClass("glue-menu-disabled")):($("#glue-contextmenu-video-mute").removeClass("glue-menu-enabled"),$("#glue-contextmenu-video-mute").addClass("glue-menu-disabled"))}),$.glue.contextmenu.register("video","video-mute",e),e=$('<img src="'+$.glue.base_url+'modules/video/video-ratio.png" alt="btn" title="reset video size" width="32" height="32">'),$(e).bind("glue-menu-activate",function(e){var t=$(this).data("owner"),t=$(t).children("video").first(),i=$(t).get(0).videoWidth,t=$(t).get(0).videoHeight;"number"==typeof i&&0<i&&"number"==typeof t&&0<t?$(this).css("display","block"):$(this).css("display","none")}),$(e).bind("click",function(e){var t=$(this).data("owner"),i=$(t).children("video").first(),l=$(i).get(0).videoWidth,i=$(i).get(0).videoHeight;"number"!=typeof l||l<=0||"number"!=typeof i||i<=0||($(t).trigger("glue-resizestart"),$(t).css("width",l+"px"),$(t).css("height",i+"px"),$(t).trigger("glue-resize"),$.glue.object.resizable_update_tooltip(t),$.glue.object.save(t),$(t).trigger("glue-resizestop"),$.glue.canvas.update(t))}),$.glue.contextmenu.register("video","video-ratio",e),e=$('<img src="'+$.glue.base_url+'img/download.png" alt="btn" title="download original file" width="32" height="32">'),$(e).bind("click",function(e){var t=$(this).data("owner");window.location=$.glue.base_url+"?"+$(t).attr("id")+"&download=1"}),$.glue.contextmenu.register("video","video-download",e)});